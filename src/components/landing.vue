<template>
    <f7-popup id="landing-popup" class="popup-ignore-back">
        <f7-view>
            <f7-page>
                <f7-tabs animated>
                    <f7-tab id="landing-tab-1" class="landing-page" tab-active>
                        <f7-block class="text-align-center landing-container">
                            <div class="landing-img">
                                <img src="@/assets/landing/landing-head.svg" class="img-field">
                            </div>
                            <div class="landing-content">
                                <h1 class="m-0">‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Æ‡∏∞!</h1>
                                <p>‡∏°‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏±‡∏ô‡πÄ‡∏•‡∏¢‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤</p>
                            </div>
                        </f7-block>

                        <div class="landing-actions">
                            <f7-button tab-link="#landing-tab-2" class="w-100 mb-2" fill>‡πÑ‡∏õ‡∏ï‡πà‡∏≠</f7-button>
                            <p class="text-center text-muted">
                                <f7-link href="/about/">‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÅ‡∏≠‡∏û‡∏ô‡∏µ‡πâ</f7-link>
                                ‚Ä¢
                                <f7-link href="#"
                                    @click="openSite('https://rywlatest.web.app/legal/privacy')">‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</f7-link>
                            </p>
                        </div>
                    </f7-tab>

                    <f7-tab id="landing-tab-2" class="landing-page">
                        <f7-block class="text-align-center landing-container">
                            <div class="landing-img">
                                <img src="@/assets/landing/landing-notice.svg" class="img-field">
                            </div>
                            <div class="landing-content">
                                <h1>‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÑ‡∏õ‡∏ï‡πà‡∏≠...</h1>
                                <p class="m-0">‡πÅ‡∏≠‡∏û‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏≠‡∏û‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏∞‡∏¢‡∏≠‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°
                                    ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÜ ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏¢‡∏≠‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡πå</p>
                                <p class="m-0 mt-2">‡πÅ‡∏≠‡∏û‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏î‡πÜ ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö Admin ‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô, Source code
                                    ‡∏Ç‡∏≠‡∏á‡πÅ‡∏≠‡∏û‡∏ô‡∏µ‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏´‡∏≤‡πÑ‡∏î‡πâ‡∏ö‡∏ô Github</p>
                                <p class="m-0 mt-2">‡πÅ‡∏≠‡∏û‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡πÇ‡∏î‡∏¢‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£‡πÉ‡∏ô‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏•‡∏¢ ‡∏ù‡∏∑‡∏°‡∏∑‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏•‡πâ‡∏ß‡∏ô‡πÜ :p
                                </p>
                            </div>
                        </f7-block>

                        <div class="landing-actions">
                            <f7-button tab-link="#landing-tab-3" class="w-100 mb-2" fill>‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö</f7-button>
                            <f7-button tab-link="#landing-tab-1" class="w-100">‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ</f7-button>
                        </div>
                    </f7-tab>

                    <f7-tab id="landing-tab-3" class="landing-page">
                        <f7-block class="text-align-center landing-container">
                            <div class="landing-img">
                                <img src="@/assets/landing/landing-user.png" class="img-field img-shadow-sm">
                            </div>
                            <div class="landing-content">
                                <h1>‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡πÑ‡∏´‡∏°?</h1>
                                <p>‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡πÅ‡∏≠‡∏û‡∏ô‡∏µ‡πâ‡∏î‡∏π‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏° ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡πÅ‡∏•‡∏∞‡∏≠‡∏∑‡πà‡∏ô‡πÜ</p>
                            </div>
                        </f7-block>

                        <div class="landing-actions">
                            <f7-button @click="openLogin" tab-link="#landing-tab-empty" class="w-100 mb-2"
                                fill>‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ</f7-button>
                            <f7-button popup-close tab-link="#landing-tab-1" @click="landingSetDone" class="w-100">‡πÉ‡∏ä‡πâ‡πÅ‡∏≠‡∏û‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ</f7-button>
                            <f7-button tab-link="#landing-tab-2" class="w-100">‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ</f7-button>
                        </div>
                    </f7-tab>

                    <f7-tab id="landing-tab-empty" class="landing-page">
                    </f7-tab>
                </f7-tabs>
            </f7-page>
        </f7-view>
    </f7-popup>

    <f7-popup id="landing-welcome-popup">
        <f7-view>
            <f7-page>
                <f7-tabs animated>
                    <f7-tab id="landing-welcome-tab-1" class="landing-page" tab-active>
                        <f7-block class="text-align-center landing-container" v-if="userData">
                            <div class="landing-img">
                                <p style="font-size: 30vw;" class="m-0">üëã</p>
                            </div>
                            <div class="landing-content">
                                <h1>‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏Æ‡∏∞!<br>‡∏Ñ‡∏∏‡∏ì{{ userData.firstname }} {{ userData.surname }}</h1>
                                <p>‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡πÅ‡∏≠‡∏û ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î ‡∏£‡∏∞‡∏¢‡∏≠‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡πå!</p>
                            </div>
                        </f7-block>

                        <div class="landing-actions">
                            <f7-button tab-link="#landing-welcome-preload" @click="startReload" class="w-100 mb-2"
                                fill>‡∏°‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏±‡∏ô‡πÄ‡∏•‡∏¢!</f7-button>
                        </div>
                    </f7-tab>

                    <f7-tab id="landing-welcome-preload" class="landing-page" tab-active>
                        <f7-preloader />
                        <i class="mt-2">‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà...</i>
                    </f7-tab>
                </f7-tabs>
            </f7-page>
        </f7-view>
    </f7-popup>
</template>

<script setup>
import { onMounted, ref } from "vue";
import store from '@/js/store.js';
import { f7 } from "framework7-vue"
import { Preferences } from "@capacitor/preferences"
import { Browser } from '@capacitor/browser';

const userData = ref(null)

const openSite = async (url) => {
    await Browser.open({ url });
}

const landingSetDone = async () => {
    await Preferences.set({ key: "landingDone", value: "1" })
}

const openLogin = async () => {
    const ls = f7.loginScreen.open("#info-register-screen")

    ls.once('close', () => {
        if (store.state.userData && store.state.userData["firstname"] != "") {
            userData.value = store.state.userData
            f7.popup.open("#landing-welcome-popup")

            landingSetDone()
        }
    })

    setTimeout(() => {
        f7.popup.close("#landing-popup", false)
    }, 250);
}

const startReload = () => {
    setTimeout(() => {
        window.location.reload()
    }, 2000);
}

onMounted(() => {
})
</script>